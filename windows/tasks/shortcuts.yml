---
- name: Remove the NodeJS folder
  win_file:
    path: "{{ windows_startmenu_shortcut_path }}\\Node.js"
    state: absent
- name: Check if the OSSEC start menu shortcut is in the default location
  win_stat: 
    path: "{{ windows_startmenu_shortcut_path }}\\OSSEC\\Manage Agent.lnk"
  register: ossec_agent
- name: Move the OSSEC shortcut to the parent directory if it is in the default location
  win_shell: "mv '{{ windows_startmenu_shortcut_path }}\\OSSEC\\Manage Agent.lnk' '{{ windows_startmenu_shortcut_path }}\\OSSEC.lnk'"
  when: ossec_agent.stat.exists
- name: Remove the OSSEC folder from the start menu
  win_file:
    path: "{{ windows_startmenu_shortcut_path }}\\OSSEC"
    state: absent
- name: Detect Python folder location
  win_find:
    paths: "{{ windows_startmenu_shortcut_path }}"
    patterns: ['Python*']
    file_type: directory
  register: python_folder
- debug:
    var: python_folder
- name: Remove the Python folder
  win_file:
    path: "{{ python_folder.files[0].path }}"
    state: absent
  when: python_folder.matched == 1
- name: Check if the Visual Studio Code start menu shortcut is in the default location
  win_stat:
    path: "{{ windows_startmenu_shortcut_path }}\\Visual Studio Code\\Visual Studio Code.lnk"
  register: vscode_shortcut
- name: Move Visual Studio Code shortcut to parent directory if it is in the default location
  win_shell: "mv '{{ windows_startmenu_shortcut_path }}\\Visual Studio Code\\Visual Studio Code.lnk' '{{ windows_startmenu_shortcut_path }}\\Visual Studio Code.lnk'"
  when: vscode_shortcut.stat.exists
- name: Remove the Visual Studio Code folder from the start menu
  win_file:
    path: "{{ windows_startmenu_shortcut_path }}\\Visual Studio Code"
    state: absent
- name: Check if the VLC start menu shortcut is in the default location
  win_stat:
    path: "{{ windows_startmenu_shortcut_path }}\\VideoLAN\\VLC media player.lnk"
  register: vlc_shortcut
- name: Move VLC shortcut to parent directory if it is in the default location
  win_shell: "mv '{{ windows_startmenu_shortcut_path }}\\VideoLAN\\VLC media player.lnk' '{{ windows_startmenu_shortcut_path }}\\VLC media player.lnk'"
  when: vlc_shortcut.stat.exists
- name: Remove the VLC folder from the start menu
  win_file:
    path: "{{ windows_startmenu_shortcut_path }}\\VideoLAN"
    state: absent
- name: Remove all of the desktop icons
  win_shell: Remove-Item C:\Users\*\Desktop\*lnk -Force


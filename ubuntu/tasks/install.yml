---
- name: Add repositories
  apt_repository:
    repo: "{{ item }}"
  with_items: "{{ repositories }}"
- name: Update and upgrade repositories
  apt:
    cache_valid_time: 86400 # One day
    update_cache: yes
    upgrade: yes
- name: Install software
  apt:
    name: "{{ item.name | default(item) }}"
    state: "{{ item.state | default('present') }}"
  with_items: "{{ software }}"
- name: Install snaps
  snap:
    name: "{{ item.name | default(item) }}"
    classic: "{{ item.classic | default('no') }}"
  with_items: "{{ snaps }}"

---
# I like that you used go here -- it's best for us to install from source wherever possible (unless the provider is super trustable e.g. Microsoft and maybe a couple others)
# Let's figure out how to incorporate this into the generic installer
# We can add an option that adds the link you do in the second step
- name: "Ensure {{ app_name }} is built"
  command: go install github.com/gabrie30/ghorg@latest
  args:
    creates: "{{ ghorg_goroot }}/bin/ghorg"
  environment:
    GOPATH: "{{ ghorg_goroot }}"

- name: "Ensure {{ app_name }} is linked"
  file:
    src: "{{ ghorg_goroot }}/bin/ghorg"
    dest: /usr/local/bin/ghorg
    state: link

- name: Run Linux user tasks
  include_tasks: user-Linux.yml
  loop: "{{ user_configs }}"
  loop_control:
    label: "{{ user.username }}"
    loop_var: user
  when: (user.system is not defined) or ((user.system is defined) and (not user.system))

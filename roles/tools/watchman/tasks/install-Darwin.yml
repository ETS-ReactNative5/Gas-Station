---
- name: "Ensure {{ app_name }} is installed"
  community.general.homebrew:
    name: watchman
    state: "{{ app_state | default('present') }}"

- name: Ensure system configuration is updated
  lineinfile:
    path: /etc/sysctl.conf
    regex: "{{ item.regex }}"
    line: "{{ item.value }}"
  loop:
    - regex: '^.*kern.maxfilesperproc.*'
      value: kern.maxfiles=10485760
    - regex: '^.*kern.maxfilesperproc.*'
      value: kern.maxfilesperproc=1048576

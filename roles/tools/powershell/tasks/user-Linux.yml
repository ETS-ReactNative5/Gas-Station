---
- name: Ensure the PowerShell config directory exists # TODO: Figure out the minimum permission for this to work
  become: yes
  become_user: "{{ user }}"
  file:
    path: "{{ item }}"
    state: directory
    user: "{{ user }}"
    group: "{{ user }}"
    mode: "755"
  loop:
    - ~/.config
    - ~/.config/powershell

- name: Copy the PowerShell profile # TODO: Figure out the minimum permission for this to work
  become: yes
  become_user: "{{ user }}"
  copy:
    src: Microsoft.PowerShell_profile.ps1
    dest: ~/.config/powershell/Microsoft.PowerShell_profile.ps1
    user: "{{ user }}"
    group: "{{ user }}"
    mode: "700"

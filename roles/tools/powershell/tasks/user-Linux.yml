---
- name: Ensure the PowerShell config directory exists # TODO: Figure out the minimum permission for this to work
  file:
    path: "{{ item }}"
    state: directory
    owner: "{{ user.username }}"
    group: "{{ user.username }}"
    mode: 0755
  loop:
    - ~/.config
    - ~/.config/powershell

- name: Copy the PowerShell profile # TODO: Figure out the minimum permission for this to work
  copy:
    src: Microsoft.PowerShell_profile.ps1
    dest: ~/.config/powershell/Microsoft.PowerShell_profile.ps1
    owner: "{{ user.username }}"
    group: "{{ user.username }}"
    mode: 0700

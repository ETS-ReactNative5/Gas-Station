---
- name: Ensure application root folder exists
  file:
    mode: 0755
    path: "{{ projects_dir }}"
    state: directory

- name: Create Graylog app folder
  file:
    path: "{{ projects_dir }}/Graylog"
    state: directory

- name: Generate the docker-compose.yml file
  template:
    dest: "{{ projects_dir }}/Graylog/docker-compose.yml"
    src: docker-compose.yml.j2

- name: Run docker-compose up -d
  shell: "cd {{ projects_dir }}/Graylog && /snap/bin/docker-compose up -d"

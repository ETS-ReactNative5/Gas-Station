---
- name: Allow Syslog TCP for Graylog
  become: yes
  ufw:
    rule: allow
    port: "1514"
    proto: tcp
    src: "{{ item }}"
    comment: Allow Syslog TCP (Graylog)
  loop:
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.168.0.0/16
- name: Allow Syslog UDP for Graylog
  become: yes
  ufw:
    rule: allow
    port: "1514"
    proto: udp
    src: "{{ item }}"
    comment: Allow Syslog UDP (Graylog)
  loop:
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.168.0.0/16
- name: Allow GELF TCP for Graylog
  become: yes
  ufw:
    rule: allow
    port: "12201"
    proto: tcp
    src: "{{ item }}"
    comment: Allow GELF TCP (Graylog)
  loop:
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.168.0.0/16
- name: Allow GELF UDP for Graylog
  become: yes
  ufw:
    rule: allow
    port: "12201"
    proto: udp
    src: "{{ item }}"
    comment: Allow GELF UDP (Graylog)
  loop:
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.168.0.0/16

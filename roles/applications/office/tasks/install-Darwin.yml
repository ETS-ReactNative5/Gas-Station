---
- name: List installed MAS apps
  command: mas list
  register: mas_list
  changed_when: false

- name: Ensure configured MAS apps are installed (Apple bundled office/productivity software)
  command: "mas install '{{ item.id | default(item) }}'"
  loop: "{{ mas_apple_office_software }}"
  when: (item.id | string) not in mas_list.stdout

- name: Ensure configured MAS apps are installed (Microsoft Office)
  command: "mas install '{{ item.id | default(item) }}'"
  loop: "{{ mas_microsoft_office_software }}"
  when: (item.id | string) not in mas_list.stdout

- name: Upgrade all apps (if configured)
  command: mas upgrade
  when: mas_upgrade_all_apps

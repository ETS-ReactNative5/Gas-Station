---
- name: Ensure Wazuh dependencies are met
  apt:
    name:
      - apt-transport-https
      - curl
      - lsb-release

- name: Add Wazuh apt key
  apt_key:
    url: "{{ wazuh_apt_key_url }}"
    state: present
  register: add_repository_key

- name: Add Wazuh repository
  apt_repository:
    filename: wazuh
    repo: "{{ wazuh_repository }}"
    state: present
    update_cache: true

- name: Install Wazuh agent # TODO: Force Wazuh to use specific version
  apt:
    name: wazuh-agent
    state: present

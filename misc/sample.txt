---
molecule_maas:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/misc/maas
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/misc/maas/**/*.yml

molecule_easyengine:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/misc/easyengine
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/misc/easyengine/**/*.yml

molecule_seconion:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/misc/seconion
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/misc/seconion/**/*.yml

molecule_pfsense:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/misc/pfsense
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/misc/pfsense/**/*.yml

molecule_hosthomepage:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/misc/hosthomepage
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/misc/hosthomepage/**/*.yml

molecule_pihole:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/misc/pihole
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/misc/pihole/**/*.yml

molecule_vim:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/vim
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/vim/**/*.yml

molecule_tree:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/tree
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/tree/**/*.yml

molecule_wget:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/wget
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/wget/**/*.yml

molecule_yq:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/yq
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/yq/**/*.yml

molecule_ngrok:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/ngrok
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/ngrok/**/*.yml

molecule_googlecloudsdk:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/googlecloudsdk
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/googlecloudsdk/**/*.yml

molecule_mas:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/mas
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/mas/**/*.yml

molecule_bw:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/bw
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/bw/**/*.yml

molecule_autojump:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/autojump
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/autojump/**/*.yml

molecule_gh:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/gh
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/gh/**/*.yml

molecule_mitmproxy:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/mitmproxy
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/mitmproxy/**/*.yml

molecule_pgcli:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/pgcli
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/pgcli/**/*.yml

molecule_translate:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/translate
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/translate/**/*.yml

molecule_starship:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/starship
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/starship/**/*.yml

molecule_lpass:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/lpass
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/lpass/**/*.yml

molecule_gitextras:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/gitextras
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/gitextras/**/*.yml

molecule_azurecli:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/azurecli
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/azurecli/**/*.yml

molecule_composer:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/composer
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/composer/**/*.yml

molecule_multipass:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/multipass
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/multipass/**/*.yml

molecule_beets:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/beets
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/beets/**/*.yml

molecule_homebrew:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/homebrew
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/homebrew/**/*.yml

molecule_awscli:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/awscli
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/awscli/**/*.yml

molecule_windowsadmincenter:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/windowsadmincenter
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/windowsadmincenter/**/*.yml

molecule_yarn:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/yarn
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/yarn/**/*.yml

molecule_wpcli:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/wpcli
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/wpcli/**/*.yml

molecule_nvm:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/nvm
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/nvm/**/*.yml

molecule_shfmt:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/shfmt
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/shfmt/**/*.yml

molecule_gitsecret:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/gitsecret
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/gitsecret/**/*.yml

molecule_googler:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/googler
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/googler/**/*.yml

molecule_cointop:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/cointop
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/cointop/**/*.yml

molecule_gradle:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/gradle
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/gradle/**/*.yml

molecule_htop:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/htop
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/htop/**/*.yml

molecule_powershell:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/powershell
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/powershell/**/*.yml

molecule_juju:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/juju
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/juju/**/*.yml

molecule_pip:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/pip
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/pip/**/*.yml

molecule_ohmyzsh:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/ohmyzsh
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/ohmyzsh/**/*.yml

molecule_aria:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/aria
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/aria/**/*.yml

molecule_mcfly:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/mcfly
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/mcfly/**/*.yml

molecule_httpie:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/httpie
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/httpie/**/*.yml

molecule_bandwhich:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/bandwhich
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/bandwhich/**/*.yml

molecule_direnv:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/direnv
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/direnv/**/*.yml

molecule_gitlfs:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/gitlfs
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/gitlfs/**/*.yml

molecule_kitty:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/kitty
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/kitty/**/*.yml

molecule_ffsend:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/ffsend
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/ffsend/**/*.yml

molecule_nmap:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/nmap
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/nmap/**/*.yml

molecule_jq:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/jq
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/jq/**/*.yml

molecule_ripgrep:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/ripgrep
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/ripgrep/**/*.yml

molecule_peco:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/peco
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/peco/**/*.yml

molecule_fzf:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/fzf
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/fzf/**/*.yml

molecule_loop:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/loop
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/loop/**/*.yml

molecule_glances:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/glances
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/glances/**/*.yml

molecule_youtubedl:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/youtubedl
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/youtubedl/**/*.yml

molecule_vault:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/vault
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/vault/**/*.yml

molecule_packer:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/tools/packer
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/tools/packer/**/*.yml

molecule_docker:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/virtualization/docker
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/virtualization/docker/**/*.yml

molecule_vagrant:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/virtualization/vagrant
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/virtualization/vagrant/**/*.yml

molecule_parallels:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/virtualization/parallels
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/virtualization/parallels/**/*.yml

molecule_virtualbox:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/virtualization/virtualbox
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/virtualization/virtualbox/**/*.yml

molecule_gitdocker:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/virtualization/gitdocker
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/virtualization/gitdocker/**/*.yml

molecule_kvm:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/virtualization/kvm
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/virtualization/kvm/**/*.yml

molecule_dockerslim:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/virtualization/dockerslim
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/virtualization/dockerslim/**/*.yml

molecule_kubernetes:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/virtualization/kubernetes
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/virtualization/kubernetes/**/*.yml

molecule_vmware:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/virtualization/vmware
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/virtualization/vmware/**/*.yml

molecule_nodejs:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/languages/nodejs
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/languages/nodejs/**/*.yml

molecule_go:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/languages/go
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/languages/go/**/*.yml

molecule_java:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/languages/java
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/languages/java/**/*.yml

molecule_php:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/languages/php
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/languages/php/**/*.yml

molecule_ruby:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/languages/ruby
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/languages/ruby/**/*.yml

molecule_dotfiles:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/dotfiles
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/dotfiles/**/*.yml

molecule_security:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/security
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/security/**/*.yml

molecule_vpn:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/vpn
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/vpn/**/*.yml

molecule_desktop:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/desktop
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/desktop/**/*.yml

molecule_firewall:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/firewall
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/firewall/**/*.yml

molecule_extensions:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/extensions
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/extensions/**/*.yml

molecule_common:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/common
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/common/**/*.yml

molecule_ssh:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/ssh
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/ssh/**/*.yml

molecule_finish:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/finish
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/finish/**/*.yml

molecule_disks:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/disks
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/disks/**/*.yml

molecule_hosts:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/hosts
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/hosts/**/*.yml

molecule_snapd:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/snapd
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/snapd/**/*.yml

molecule_connect:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/connect
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/connect/**/*.yml

molecule_dns:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/system/dns
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/system/dns/**/*.yml

molecule_droplets:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/cloud/droplets
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/cloud/droplets/**/*.yml

molecule_firefox:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/firefox
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/firefox/**/*.yml

molecule_xcode:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/xcode
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/xcode/**/*.yml

molecule_shotwell:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/shotwell
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/shotwell/**/*.yml

molecule_flameshot:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/flameshot
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/flameshot/**/*.yml

molecule_shotcut:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/shotcut
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/shotcut/**/*.yml

molecule_visualstudio:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/visualstudio
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/visualstudio/**/*.yml

molecule_office:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/office
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/office/**/*.yml

molecule_qbittorrent:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/qbittorrent
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/qbittorrent/**/*.yml

molecule_raspberryimager:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/raspberryimager
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/raspberryimager/**/*.yml

molecule_microsoftedge:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/microsoftedge
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/microsoftedge/**/*.yml

molecule_mailspring:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/mailspring
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/mailspring/**/*.yml

molecule_remotedesktop:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/remotedesktop
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/remotedesktop/**/*.yml

molecule_postman:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/postman
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/postman/**/*.yml

molecule_kodi:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/kodi
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/kodi/**/*.yml

molecule_gitkraken:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/gitkraken
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/gitkraken/**/*.yml

molecule_bravebrowser:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/bravebrowser
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/bravebrowser/**/*.yml

molecule_inkscape:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/inkscape
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/inkscape/**/*.yml

molecule_vlc:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/vlc
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/vlc/**/*.yml

molecule_teamviewer:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/teamviewer
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/teamviewer/**/*.yml

molecule_lollypop:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/lollypop
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/lollypop/**/*.yml

molecule_androidstudio:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/androidstudio
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/androidstudio/**/*.yml

molecule_chrome:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/chrome
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/chrome/**/*.yml

molecule_teams:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/teams
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/teams/**/*.yml

molecule_zoom:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/zoom
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/zoom/**/*.yml

molecule_plex:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/plex
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/plex/**/*.yml

molecule_slack:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/slack
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/slack/**/*.yml

molecule_skype:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/skype
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/skype/**/*.yml

molecule_nordvpn:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/nordvpn
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/nordvpn/**/*.yml

molecule_intellij:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/intellij
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/intellij/**/*.yml

molecule_filezilla:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/filezilla
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/filezilla/**/*.yml

molecule_vscode:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/vscode
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/vscode/**/*.yml

molecule_autokey:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/autokey
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/autokey/**/*.yml

molecule_hyper:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/hyper
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/hyper/**/*.yml

molecule_wireshark:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/wireshark
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/wireshark/**/*.yml

molecule_gimp:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/applications/gimp
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/applications/gimp/**/*.yml

molecule_startmenu:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/helpers/startmenu
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/helpers/startmenu/**/*.yml

molecule_reboot:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/helpers/reboot
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/helpers/reboot/**/*.yml

molecule_defaultbrowser:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/helpers/defaultbrowser
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/helpers/defaultbrowser/**/*.yml

molecule_dmginstall:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/helpers/dmginstall
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/helpers/dmginstall/**/*.yml

molecule_fontinstall:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/helpers/fontinstall
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/helpers/fontinstall/**/*.yml

molecule_netdata:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/netdata
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/netdata/**/*.yml

molecule_rclone:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/rclone
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/rclone/**/*.yml

molecule_certbot:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/certbot
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/certbot/**/*.yml

molecule_portout:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/portout
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/portout/**/*.yml

molecule_guacamole:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/guacamole
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/guacamole/**/*.yml

molecule_cloudflare:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/cloudflare
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/cloudflare/**/*.yml

molecule_antivirus:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/antivirus
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/antivirus/**/*.yml

molecule_zenbot:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/zenbot
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/zenbot/**/*.yml

molecule_cockpit:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/cockpit
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/cockpit/**/*.yml

molecule_elasticagent:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/elasticagent
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/elasticagent/**/*.yml

molecule_aptcacherng:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/aptcacherng
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/aptcacherng/**/*.yml

molecule_tor:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/tor
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/tor/**/*.yml

molecule_samba:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/samba
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/samba/**/*.yml

molecule_nginx:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/nginx
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/nginx/**/*.yml

molecule_filebrowser:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/filebrowser
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/filebrowser/**/*.yml

molecule_wazuh:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/wazuh
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/wazuh/**/*.yml

molecule_cups:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/cups
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/cups/**/*.yml

molecule_restic:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/restic
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/restic/**/*.yml

molecule_dnsmasq:
  stage: test
  image: docker:stable-dind
  services:
    - docker:dind
  before_script:
    - apk update && apk add --no-cache python3 python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
    - python3 -m pip install ansible molecule[docker]
  script:
    - cd roles/services/dnsmasq
    - molecule test -s docker
  only:
    refs:
      - branches
    changes:
      - roles/services/dnsmasq/**/*.yml


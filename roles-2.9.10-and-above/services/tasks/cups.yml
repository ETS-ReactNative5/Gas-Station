---
- name: Download CUPS and related packages
  apt:
    name:
      - avahi-daemon
      - cups
    state: present

- name: Copy the CUPS configuration over
  copy:
    src: cupsd.conf
    dest: /etc/cups/cupsd.conf
    owner: root
    group: root
    mode: "0644"

- name: Restart CUPS and enable on start up
  systemd:
    name: cups
    state: restarted
    enabled: yes

- name: Restart avahi-daemon and enable on start up
  systemd:
    name: avahi-daemon
    state: restarted
    enabled: yes

- name: Restart the Samba service
  service:
    name: smbd
    state: restarted

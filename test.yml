---
- hosts: all:!pfsense:!seconion
  tasks:
    - name: Determine facts based on the host's ID
      set_fact:
        fqdn: "{{ hosts[host_id].hosts.split()[-1] }}"
        hostname: "{{ hosts[host_id].hostname }}"
        host_list: "{{ hosts | list }}"
        ip_address: "{{ hosts[host_id].ip_address }}"
        nginx_sites: "{{ apps }}"
    - name: Set value for the variable vlan_ip
      set_fact:
        vlan_ip: "{{ hosts
          | map('extract', hosts) }}"
    - debug:
        msg: "{{ vlan_ip }}"
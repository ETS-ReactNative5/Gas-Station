---
- name: Ensure SSH port is not left as default
  lineinfile:
    path: /etc/ssh/sshd_config
    regex: "^#Port 22"
    line: Port 2214
- name: Prevent root login via SSH
  lineinfile:
    path: /etc/ssh/sshd_config
    regex: "^#PermitRootLogin"
    line: PermitRootLogin no
- name: Set MaxAuthTries in SSH config
  lineinfile:
    path: /etc/ssh/sshd_config
    regex: "^#MaxAuthTries"
    line: MaxAuthTries 3
- name: Set PasswordAuthentication to no in SSH config
  lineinfile:
    path: /etc/ssh/sshd_config
    regex: "^#PasswordAuthentication"
    line: PasswordAuthentication no
- name: Make sure PasswordAuthentication is not set to yes
  lineinfile:
    path: /etc/ssh/sshd_config
    regex: "^PasswordAuthentication yes$"
    line: PasswordAuthentication no
- name: Set PermitEmptyPasswords to no in SSH config
  lineinfile:
    path: /etc/ssh/sshd_config
    regex: "^#PermitEmptyPasswords"
    line: PermitEmptyPasswords no
- name: Set X11Forwarding to no in SSH config
  lineinfile:
    path: /etc/ssh/sshd_config
    regex: "^#X11Forwarding"
    line: X11Forwarding no
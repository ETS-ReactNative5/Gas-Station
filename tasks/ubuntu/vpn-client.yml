---
- name: Copy OpenVPN files
  copy:
    src: "files/openvpn"
    dest: "~/openvpn_tmp"
- name: Import OpenVPN files into the Network Manager
  shell: |
    cd ~/openvpn_tmp/mullvad-hong-kong
    sudo nmcli connection import type openvpn file "Mullvad Hong Kong.conf"
    cd ../mullvad-italy
    sudo nmcli connection import type openvpn file "Mullvad Italy.conf"
    cd ../mullvad-la
    sudo nmcli connection import type openvpn file "Mullvad LA (UDP 53).conf"
    nmcli connection modify "Mullvad LA (UDP 53) +vpn.data username={{ mullvad_id }}
    cd ../mullvad-nyc
    sudo nmcli connection import type openvpn file "Mullvad NYC.conf"
    cd ../mullvad-secaucus
    sudo nmcli connection import type openvpn file "Mullvad Secaucus.conf"
    cd ../nordvpn-usa
    nmcli connection import type openvpn file "NordVPN USA.ovpn"
    nmcli connection modify "NordVPN USA" +vpn.data username={{ nordvpn_email }}
    cd ../nordvpn-usa-2
    nmcli connection import type openvpn file "NordVPN USA2.ovpn"
    nmcli connection modify "NordVPN USA2" +vpn.data username={{ nordvpn_email }}
- name: Remove imported certificates from user directory
  file:
    path: ~/openvpn_tmp
    state: absent


---
- name: Install software
  apt:
    name: "{{ item.name | default(item) }}"
    state: "{{ item.state | default('present') }}"
  with_items: "{{ software | default([]) }}"
- name: Install snaps
  snap:
    name: "{{ item.name | default(item) }}"
    classic: "{{ item.classic | default('no') }}"
  with_items: "{{ snaps | default([]) }}"
- name: Install pips
  become: yes
  become_user: "{{ ansible_user }}"
  pip:
    name: "{{ item.name }}"
  with_items: "{{ pips | default([]) }}"
- name: Install Visual Studio Code plugins
  become: yes
  become_user: "{{ ansible_user }}"
  shell: "/snap/bin/code --install-extension {{ item }}"
  with_items: "{{ vscode_plugins | default([]) }}"
---
- name: Check if the Brave repository was already added
  stat:
    path: /etc/apt/sources.list.d/brave-browser-release.list
  register: brave_repo_file
- name: Add Brave keyring
  shell: curl -s https://brave-browser-apt-release.s3.brave.com/brave-core.asc | apt-key --keyring /etc/apt/trusted.gpg.d/brave-browser-release.gpg add -
  when: not brave_repo_file.stat.exists
- name: Add Brave repository
  shell: 'echo "deb [arch=amd64] {{ https_repository_prefix }}brave-browser-apt-release.s3.brave.com/ stable main" | sudo tee /etc/apt/sources.list.d/brave-browser-release.list'
  when: not brave_repo_file.stat.exists
- name: Install Brave Browser
  apt:
    name: brave-browser
    state: latest
    update_cache: yes
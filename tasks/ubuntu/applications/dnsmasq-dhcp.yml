---
- name: Configure dnsmasq's DHCP server if a dhcp_interface is defined
  blockinfile:
    path: /etc/dnsmasq.conf
    marker: "# ANSIBLE MANAGED CONFIGURATION BLOCK"
    block: |
      dhcp-range={{ dhcp_interface }},192.168.168.50,192.168.168.150,12h
      dhcp-option=option:router,192.168.168.1
      dhcp-option=6,192.168.168.1
      log-facility=/var/log/dnsmasq.log # Log file path
      log-async
      log-queries       # Log queries
      log-dhcp          # Log DHCP related messages
    regexp: "^#interface="
    line: "interface={{ dhcp_interface }}"
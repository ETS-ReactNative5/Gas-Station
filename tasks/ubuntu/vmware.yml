---
- name: Ensure VMWare Workstation Pro is installed (if key is defined)
  vars:
    workstation_license: "{{ vmware_workstation_key }}"
  include_role:
    name: vmware.vmware-workstation
  when: vmware_workstation_key is defined
- name: Clone Unlocker for running Mac OS X on VMWare
  git:
    repo: https://github.com/paolo-projects/unlocker.git
    dest: /tmp/unlocker
    force: yes
- name: Update python to python3 in lnx-install.sh
  lineinfile:
    path: /tmp/unlocker/lnx-install.sh
    regex: "python gettools.py"
    line: python3 gettools.py
- name: Install Unlocker dependencies
  apt:
    name: python2
    state: latest
- name: Patch VMWare for Mac OS X
  shell: cd /tmp/unlocker && bash lnx-install.sh
- name: Remove Unlockr folder from /tmp/unlocker
  file:
    path: /tmp/unlocker
    state: absent
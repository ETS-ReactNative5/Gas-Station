---
- name: "Install Vagrant via Chocolatey"
  win_chocolatey:
    name: vagrant
    state: latest
- name: Check if Vagrant installation is in default location
  win_stat:
    path: C:\HashiCorp
  register: hashicorp_default_location
- name: Move the Vagrant installation to Program Files
  win_shell: Move-Item C:\HashiCorp\Vagrant "C:\Program Files\Vagrant"
  when:
    - hashicorp_default_location.stat.exists is defined
    - hashicorp_default_location.stat.exists
- name: Delete original Vagrant directory
  win_file:
    path: C:\HashiCorp
    state: absent
- name: Remove original Vagrant PATH
  win_path:
    elements: C:\HashiCorp\Vagrant\bin
    state: absent
- name: Add new Vagrant PATH
  win_path:
    elements: C:\Program Files\Vagrant\bin
    state: present
---
- name: Ensure PowerShell start script directory exists
  win_file:
    path: "%USERPROFILE%\\Documents\\WindowsPowerShell"
    state: directory
- name: Copy PowerShell start script
  win_copy:
    src: files/dotfiles/config/powershell/Microsoft.PowerShell_profile.ps1
    dest: "%USERPROFILE%\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1"
  register: git_profile
- name: Copy .gitconfig
  win_copy:
    src: files/dotfiles/.gitconfig
    dest: "%USERPROFILE%\\.gitconfig"
- name: Copy .localrc
  win_copy:
    src: files/dotfiles/.localrc
    dest: "%USERPROFILE%\\.localrc"
- name: Ensure .bashrc exists
  win_file:
    path: "%USERPROFILE%\\.bashrc"
    state: touch
  ignore_errors: yes
- name: Source .localrc from .bashrc (if the source call does not already exist)
  win_lineinfile:
    path: "%USERPROFILE%\\.bashrc"
    regex: "^source ~\/.localrc$"
    line: source ~/.localrc
- name: Copy .netrc
  win_copy:
    src: files/dotfiles/.netrc
    dest: "%USERPROFILE%\\.netrc"
- name: Copy .npmrc
  win_copy:
    src: files/dotfiles/.npmrc
    dest: "%USERPROFILE%\\.npmrc"
- name: Copy .zshrc
  win_copy:
    src: files/dotfiles/.zshrc
    dest: "%USERPROFILE%\\.zshrc"
- name: Check if Hyper.js is installed
  win_stat:
    path: "%USERPROFILE%\\AppData\\Roaming\\Hyper"
  register: hyper_install_dir
- name: Copy .hyper.js
  win_copy:
    src: files/dotfiles/.hyper.js
    dest: "%USERPROFILE%\\AppData\\Roaming\\Hyper\\.hyper.js"
  when:
    - hyper_install_dir.stat.exists
- name: Update font size in .hyper.js for Windows
  win_lineinfile:
    path: "%USERPROFILE%\\.hyper.js"
    regex: "fontSize: 12,"
    line: "fontSize: 15,"
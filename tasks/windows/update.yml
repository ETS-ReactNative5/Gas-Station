# Copyright 2020, Megabyte LLC <help@megabyte.space>

# Applies Windows updates and reboots the computers if necessary

---
- name: Install all critical and security updates
  win_updates:
    category_names:
    - CriticalUpdates
    - SecurityUpdates
    - UpdateRollups
    state: installed
  register: update_result
- name: Reboot host if required
  win_reboot:
    post_reboot_delay: 140
  when: update_result.reboot_required
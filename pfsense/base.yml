# Copyright 2020, Megabyte LLC <help@megabyte.space>

# Set up pfSense

---
hosts: pfsense
tasks:
  - name: Set up general settings
    pfsense_setup:
      dashboardavailablewidgetspanel: true
      dashboardcolumns: 3
      domain: megabyte.space
      hostname: brock
      language: en
      logincss: 
      statusmonitoringsettingspanel: true
      systemlogsfilterpanel: true
      systemlogsmanagelogpanel: true
      timeservers:
      timezone: America/New_York
      webguicss: pfSense-dark
      webguifixedmenu: true
      webguihostnamemenu: nohost
      webguileftcolumnhyper: false
  - name: Set up VLAN69
    pfsense_vlan:
      descr: VLAN69
      interface: XG16 # fill in with proper interface
      priority: 5
      state: present
      vlan_id: 69
  - name: Set up VLAN69 DHCP server
    pfsense_interface:
      descr: VLAN69 interface
      enable: true
      interface: XG16.69
      ipv4_address: 10.24.69.1
      ipv4_prefixlen: 29
      ipv4_type: dhcp
      state: present
  - name: Set up Kubernetes VLAN
    pfsense_vlan:
      descr: Kubernetes
      interface: XG16 # proper interface
      priority: 4
      state: present
      vlan_id: 14
  - name: Set up guest VLAN
    pfsense_vlan:
      descr: Restricted
      interface: XG16 # proper interface
      priority: 1
      state: present
      vlan_id: 11
  - name: Set up guest VLAN DHCP server
    pfsense_interface:
      desc: Restricted interface
      enable: true
      interface: XG16.11
      ipv4_address: 10.24.11.1
      ipv4_prefixlen: 24
      ipv4_type: dhcp
      state: present
